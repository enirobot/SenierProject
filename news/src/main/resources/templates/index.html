<!DOCTYPE HTML>
<!--
	Lens by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script th:src="@{/js/lib/wordcloud2.js}"></script> <!-- 추가 -->
		<title>Lens by HTML5 UP</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" th:href="@{/css/main.css}" />
		<noscript><link rel="stylesheet" th:href="@{/css/noscript.css}" /></noscript>
	</head>
	<body class="is-preload-0 is-preload-1 is-preload-2">

		<!-- Main -->
			<div id="main">

				<!-- Header -->
					<header id="header">
						<!--<h1>Lens</h1>
						<p>Just another fine responsive site template by <a href="http://html5up.net">HTML5 UP</a></p>
						<ul class="icons">
							<li><a href="#" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
							<li><a href="#" class="icon fa-instagram"><span class="label">Instagram</span></a></li>
							<li><a href="#" class="icon fa-github"><span class="label">Github</span></a></li>
							<li><a href="#" class="icon fa-envelope-o"><span class="label">Email</span></a></lßi>
						</ul>-->
						<h1>알 뉴스</h1>
						<p>공공이슈 추출 플랫폼</p>
					</header>

				<!-- Thumbnail -->
					<section id="thumbnails">
						<article>
							<a class="thumbnail" th:href="@{/images/fulls/01.jpg}" data-position="left center"><img th:src="@{/images/thumbs/wordcloud.jpg}" alt="" />
								<h2>WordCloud</h2>
							<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
						</article>
						<article>
							<a class="thumbnail" th:href="@{/images/fulls/02.jpg}"><img th:src="@{/images/thumbs/sankey.jpg}" alt="" /></a>
							<h2>Sankey Diagram</h2>
							<p>Sed velit lacus, laoreet at venenatis convallis in lorem tincidunt.</p>
						</article>
						<article>
							<a class="thumbnail" th:href="@{/images/fulls/03.jpg}" data-position="top center"><img th:src="@{/images/thumbs/03.jpg}" alt="" /></a>
							<h2>Line Chart</h2>
							<p>Maecenas eleifend tellus ut turpis eleifend, vitae pretium faucibus.</p>
						</article>
						<article>
							<a class="thumbnail" th:href="@{/images/fulls/04.jpg}"><img th:src="@{/images/thumbs/04.jpg}" alt="" /></a>
							<h2>Pie Chart</h2>
							<p>Tristique in nulla vel congue. Sed sociis natoque parturient nascetur.</p>
						</article>
						<article>
							<a class="thumbnail" th:href="@{/images/fulls/05.jpg}" data-position="top center"><img th:src="@{/images/thumbs/05.jpg}" alt="" /></a>
							<h2>Heat Map</h2>
							<p>In pellentesque cursus velit id posuere. Donec vehicula nulla.</p>
						</article>

					</section>

				<!-- Footer -->
					<footer id="footer">
						<ul class="copyright">
							<!--<li>&copy; Untitled.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a>.</li>-->
							<li>프로젝트 오공</li>
						</ul>
					</footer>

			</div>

		<!-- Scripts -->
			<script th:src="@{/js/jquery.min.js}"></script>
			<script th:src="@{/js/browser.min.js}"></script>
			<script th:src="@{/js/breakpoints.min.js}"></script>
			<script th:src="@{/js/main.js}"></script>

	</body>
</html>



<script type="text/javascript">
    // var div = document.getElementById("surrounding_div");
    // var canvas = document.getElementById("canvas_cloud");
    var canvas = document.getElementById("canvas_cloud")
    var arr = [];

    // canvas.height = div.offsetHeight;
    // canvas.width  = div.offsetWidth;

    //html이 로딩되고 실행
    $(document).ready(function(){
        var data = null;


        $.ajax({
            url: "/WordCloud",
            type: "POST",
            dataType: "json",
            contentType: "application/json",
            data: JSON.stringify(data),
            success: function(result) {

                // arr = [];
                arr.length = 0;

                for (var i = 0; i < result.length; i++) {
                    arr.push( [ result[i].word,
                        result[i].totalWeight,
                        result[i].idList ] );
                }

                var options = {
                    list : arr,
                    gridSize: Math.round(2 * document.getElementById('canvas_cloud').offsetWidth / 1024),
                    weightFactor: function (size) {
                        return Math.pow(size, 2) * document.getElementById('canvas_cloud').offsetWidth / 1024;
                    },
                    weightFactor: 7,
                    minSize: 3,
                    figPath: "circle",
                    click: function(item) {
                        alert("word : " + item[0] + " totalWeight : " + item[1]);
                        location.href= "/mainNewsList?"+item[2];
                    }
                }

                WordCloud(document.getElementById('canvas_cloud'), options);
            },
            error : function () {
                alert("fail");
            }
        })
    });

    $('input[id="search"]').keydown(function() {
        if (event.keyCode === 13) {

            $.ajax({
                url: "/findKeyword",
                type: "POST",
                dataType: "json",
                contentType: "application/json",
                data: JSON.stringify( document.getElementById('search').value ),
                success: function(result) {

                    // arr = [];    // 완전 초기화
                    arr.length = 0;

                    for (var i = 0; i < result.length; i++) {
                        arr.push( [ result[i].word,
                            result[i].counts,
                            result[i].idList ] );
                    }

                    var options = {
                        list : arr,
                        gridSize: Math.round(2 * document.getElementById('canvas_cloud').offsetWidth / 1024),
                        weightFactor: function (size) {
                            return Math.pow(size, 2) * document.getElementById('canvas_cloud').offsetWidth / 1024;
                        },
                        weightFactor: 5,
                        minSize: 3,
                        figPath: "circle",
                        click: function(item) {
                            alert("word : " + item[0] + " count : " + item[1]);
                            location.href= "/mainSearchNewsList?" + item[2];
                        }
                    }

                    WordCloud(document.getElementById('canvas_cloud'), options);
                },
                error : function () {
                    alert("fail");
                }
            })

        }
    });

</script>
