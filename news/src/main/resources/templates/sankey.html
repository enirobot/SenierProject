<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>
<body>
<div id="sankey_basic" style="width: 900px; height: 300px;"></div>

<script type="text/javascript">
    google.charts.load('current', {'packages':['sankey']});
    google.charts.setOnLoadCallback(drawChart);

    var inputdata = [];

    // var inputdata=[
    //     [ "A", 'X', 5 ],
    //     [ 'A', 'Y', 7 ],
    //     [ 'A', 'Z', 6 ],
    //     [ 'B', 'X', 2 ],
    //     [ 'B', 'Y', 9 ],
    //     [ 'B', 'Z', 4 ]
    // ];


    $(document).ready(function(){
        $.ajax({
            url: "/sankey_post",
            type: "POST",
            dataType: "json",
            contentType: "application/json",
            data: JSON.stringify(null),
            success: function(data) {
                for (var i = 0; i < data.length; i++) {
                    inputdata.push( [ data[i].source, data[i].destination, data[i].value ] );
                }

            }
        })
    });


    function drawChart() {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'From');
        data.addColumn('string', 'To');
        data.addColumn('number', 'Weight');
        data.addRows(inputdata);

        // Sets chart options.
        var options = {
            width: 600,
        };

        // Instantiates and draws our chart, passing in some options.
        var chart = new google.visualization.Sankey(document.getElementById('sankey_basic'));
        chart.draw(data, options);
    }
</script>
</body>
</html>